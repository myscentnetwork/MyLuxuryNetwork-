generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model Size {
  id         String         @id @default(cuid())
  name       String         @unique
  status     String         @default("active")
  createdAt  DateTime       @default(now())
  categories CategorySize[]
  products   ProductSize[]
}

model Category {
  id          String               @id @default(cuid())
  name        String
  logo        String?
  status      String               @default("active")
  createdAt   DateTime             @default(now())
  brands      BrandCategory[]
  sizes       CategorySize[]
  products    Product[]
  resellers   ResellerCategory[]
  retailers   RetailerCategory[]
  vendors     VendorCategory[]
  wholesalers WholesalerCategory[]
}

model CategorySize {
  id         String   @id @default(cuid())
  categoryId String
  sizeId     String
  size       Size     @relation(fields: [sizeId], references: [id], onDelete: Cascade)
  category   Category @relation(fields: [categoryId], references: [id], onDelete: Cascade)

  @@unique([categoryId, sizeId])
}

model Brand {
  id         String          @id @default(cuid())
  name       String
  slug       String          @unique
  logo       String?
  status     String          @default("active")
  createdAt  DateTime        @default(now())
  categories BrandCategory[]
  products   Product[]
}

model BrandCategory {
  id         String   @id @default(cuid())
  brandId    String
  categoryId String
  category   Category @relation(fields: [categoryId], references: [id], onDelete: Cascade)
  brand      Brand    @relation(fields: [brandId], references: [id], onDelete: Cascade)

  @@unique([brandId, categoryId])
}

model Product {
  id                 String              @id @default(cuid())
  name               String?
  sku                String              @unique
  description        String?
  video              String?
  isFeatured         Boolean             @default(false)
  isNewArrival       Boolean             @default(false)
  isBestSeller       Boolean             @default(false)
  status             String              @default("out_of_stock")
  stockQuantity      Int                 @default(0)
  mrp                Float               @default(0)
  costPrice          Float               @default(0)
  wholesalePrice     Float               @default(0)
  resellerPrice      Float               @default(0)
  retailPrice        Float               @default(0)
  createdAt          DateTime            @default(now())
  updatedAt          DateTime            @updatedAt
  categoryId         String
  brandId            String
  videoUrl           String?
  brand              Brand               @relation(fields: [brandId], references: [id])
  category           Category            @relation(fields: [categoryId], references: [id])
  colours            ProductColour[]
  images             ProductImage[]
  sizes              ProductSize[]
  tags               ProductTag[]
  purchaseItems      PurchaseItem[]
  resellerProducts   ResellerProduct[]
  retailerProducts   RetailerProduct[]
  wholesalerProducts WholesalerProduct[]
}

model ProductSize {
  id        String  @id @default(cuid())
  productId String
  sizeId    String
  size      Size    @relation(fields: [sizeId], references: [id], onDelete: Cascade)
  product   Product @relation(fields: [productId], references: [id], onDelete: Cascade)

  @@unique([productId, sizeId])
}

model ProductImage {
  id        String  @id @default(cuid())
  url       String
  order     Int     @default(0)
  productId String
  product   Product @relation(fields: [productId], references: [id], onDelete: Cascade)
}

model ProductTag {
  id        String  @id @default(cuid())
  name      String
  productId String
  product   Product @relation(fields: [productId], references: [id], onDelete: Cascade)

  @@unique([productId, name])
}

model ProductColour {
  id        String  @id @default(cuid())
  name      String
  productId String
  product   Product @relation(fields: [productId], references: [id], onDelete: Cascade)

  @@unique([productId, name])
}

model Vendor {
  id            String           @id @default(cuid())
  name          String
  phone         String?
  city          String?
  status        String           @default("active")
  createdAt     DateTime         @default(now())
  purchaseBills PurchaseBill[]
  categories    VendorCategory[]
}

model VendorCategory {
  id         String   @id @default(cuid())
  vendorId   String
  categoryId String
  category   Category @relation(fields: [categoryId], references: [id], onDelete: Cascade)
  vendor     Vendor   @relation(fields: [vendorId], references: [id], onDelete: Cascade)

  @@unique([vendorId, categoryId])
}

model Reseller {
  id                    String             @id @default(cuid())
  username              String?            @unique
  name                  String
  contactNumber         String?
  whatsappNumber        String?
  shopName              String?
  email                 String?            @unique
  password              String?
  storeAddress          String?
  customDomain          String?
  status                String             @default("inactive")
  registrationStatus    String             @default("approved")
  createdAt             DateTime           @default(now())
  resetToken            String?            @unique
  resetTokenExpiry      DateTime?
  storeLogo             String?
  storeBanner           String?
  tagline               String?
  instagramHandle       String?
  facebookHandle        String?
  youtubeHandle         String?
  telegramHandle        String?
  autoImportEnabled     Boolean            @default(false)
  autoImportMarkupType  String?
  autoImportMarkupValue Float?
  orderBills            OrderBill[]
  selectedCategories    ResellerCategory[]
  importedProducts      ResellerProduct[]
}

model Wholesaler {
  id                    String               @id @default(cuid())
  username              String?              @unique
  name                  String
  companyName           String?
  contactNumber         String?
  whatsappNumber        String?
  email                 String?              @unique
  password              String?
  address               String?
  city                  String?
  gstNumber             String?
  status                String               @default("inactive")
  registrationStatus    String               @default("approved")
  createdAt             DateTime             @default(now())
  resetToken            String?              @unique
  resetTokenExpiry      DateTime?
  storeLogo             String?
  storeBanner           String?
  tagline               String?
  instagramHandle       String?
  facebookHandle        String?
  youtubeHandle         String?
  telegramHandle        String?
  autoImportEnabled     Boolean              @default(false)
  autoImportMarkupType  String?
  autoImportMarkupValue Float?
  orderBills            WholesaleOrderBill[]
  selectedCategories    WholesalerCategory[]
  importedProducts      WholesalerProduct[]
}

model WholesalerCategory {
  id           String     @id @default(cuid())
  wholesalerId String
  categoryId   String
  createdAt    DateTime   @default(now())
  category     Category   @relation(fields: [categoryId], references: [id], onDelete: Cascade)
  wholesaler   Wholesaler @relation(fields: [wholesalerId], references: [id], onDelete: Cascade)

  @@unique([wholesalerId, categoryId])
}

model Retailer {
  id                    String             @id @default(cuid())
  username              String?            @unique
  name                  String
  contactNumber         String?
  whatsappNumber        String?
  email                 String?            @unique
  password              String?
  address               String?
  city                  String?
  status                String             @default("inactive")
  registrationStatus    String             @default("approved")
  createdAt             DateTime           @default(now())
  resetToken            String?            @unique
  resetTokenExpiry      DateTime?
  storeLogo             String?
  storeBanner           String?
  tagline               String?
  instagramHandle       String?
  facebookHandle        String?
  youtubeHandle         String?
  telegramHandle        String?
  autoImportEnabled     Boolean            @default(false)
  autoImportMarkupType  String?
  autoImportMarkupValue Float?
  orderBills            RetailOrderBill[]
  selectedCategories    RetailerCategory[]
  importedProducts      RetailerProduct[]
}

model RetailerCategory {
  id         String   @id @default(cuid())
  retailerId String
  categoryId String
  createdAt  DateTime @default(now())
  category   Category @relation(fields: [categoryId], references: [id], onDelete: Cascade)
  retailer   Retailer @relation(fields: [retailerId], references: [id], onDelete: Cascade)

  @@unique([retailerId, categoryId])
}

model RetailOrderBill {
  id            String            @id @default(cuid())
  invoiceNumber String            @unique
  date          String
  time          String?
  subtotal      Float             @default(0)
  totalDiscount Float             @default(0)
  grandTotal    Float             @default(0)
  status        String            @default("pending")
  createdAt     DateTime          @default(now())
  updatedAt     DateTime          @updatedAt
  retailerId    String
  retailer      Retailer          @relation(fields: [retailerId], references: [id])
  items         RetailOrderItem[]
}

model RetailOrderItem {
  id             String          @id @default(cuid())
  quantity       Int
  unitPrice      Float
  discountType   String          @default("none")
  discountValue  Float           @default(0)
  discountAmount Float           @default(0)
  total          Float
  productSku     String
  productName    String
  productImage   String?
  orderBillId    String
  productId      String
  orderBill      RetailOrderBill @relation(fields: [orderBillId], references: [id], onDelete: Cascade)
}

model WholesaleOrderBill {
  id            String               @id @default(cuid())
  invoiceNumber String               @unique
  date          String
  time          String?
  subtotal      Float                @default(0)
  totalDiscount Float                @default(0)
  grandTotal    Float                @default(0)
  status        String               @default("pending")
  createdAt     DateTime             @default(now())
  updatedAt     DateTime             @updatedAt
  wholesalerId  String
  wholesaler    Wholesaler           @relation(fields: [wholesalerId], references: [id])
  items         WholesaleOrderItem[]
}

model WholesaleOrderItem {
  id             String             @id @default(cuid())
  quantity       Int
  unitPrice      Float
  discountType   String             @default("none")
  discountValue  Float              @default(0)
  discountAmount Float              @default(0)
  total          Float
  productSku     String
  productName    String
  productImage   String?
  orderBillId    String
  productId      String
  orderBill      WholesaleOrderBill @relation(fields: [orderBillId], references: [id], onDelete: Cascade)
}

model ResellerCategory {
  id         String   @id @default(cuid())
  resellerId String
  categoryId String
  createdAt  DateTime @default(now())
  category   Category @relation(fields: [categoryId], references: [id], onDelete: Cascade)
  reseller   Reseller @relation(fields: [resellerId], references: [id], onDelete: Cascade)

  @@unique([resellerId, categoryId])
}

model ResellerProduct {
  id             String   @id @default(cuid())
  resellerId     String
  productId      String
  sellingPrice   Float?
  markupType     String?
  markupValue    Float?
  isAutoImported Boolean  @default(false)
  isVisible      Boolean  @default(true)
  displayOrder   Int      @default(0)
  createdAt      DateTime @default(now())
  product        Product  @relation(fields: [productId], references: [id], onDelete: Cascade)
  reseller       Reseller @relation(fields: [resellerId], references: [id], onDelete: Cascade)

  @@unique([resellerId, productId])
}

model WholesalerProduct {
  id             String     @id @default(cuid())
  wholesalerId   String
  productId      String
  sellingPrice   Float?
  markupType     String?
  markupValue    Float?
  isAutoImported Boolean    @default(false)
  isVisible      Boolean    @default(true)
  displayOrder   Int        @default(0)
  createdAt      DateTime   @default(now())
  product        Product    @relation(fields: [productId], references: [id], onDelete: Cascade)
  wholesaler     Wholesaler @relation(fields: [wholesalerId], references: [id], onDelete: Cascade)

  @@unique([wholesalerId, productId])
}

model RetailerProduct {
  id             String   @id @default(cuid())
  retailerId     String
  productId      String
  sellingPrice   Float?
  markupType     String?
  markupValue    Float?
  isAutoImported Boolean  @default(false)
  isVisible      Boolean  @default(true)
  displayOrder   Int      @default(0)
  createdAt      DateTime @default(now())
  product        Product  @relation(fields: [productId], references: [id], onDelete: Cascade)
  retailer       Retailer @relation(fields: [retailerId], references: [id], onDelete: Cascade)

  @@unique([retailerId, productId])
}

model OrderBill {
  id            String      @id @default(cuid())
  invoiceNumber String      @unique
  date          String
  time          String?
  subtotal      Float       @default(0)
  totalDiscount Float       @default(0)
  grandTotal    Float       @default(0)
  status        String      @default("pending")
  createdAt     DateTime    @default(now())
  updatedAt     DateTime    @updatedAt
  resellerId    String
  reseller      Reseller    @relation(fields: [resellerId], references: [id])
  items         OrderItem[]
}

model OrderItem {
  id             String    @id @default(cuid())
  quantity       Int
  unitPrice      Float
  discountType   String    @default("none")
  discountValue  Float     @default(0)
  discountAmount Float     @default(0)
  total          Float
  productSku     String
  productName    String
  productImage   String?
  orderBillId    String
  productId      String
  orderBill      OrderBill @relation(fields: [orderBillId], references: [id], onDelete: Cascade)
}

model PurchaseBill {
  id                 String            @id @default(cuid())
  billNumber         String            @unique
  date               String
  time               String?
  shippingCharges    Float             @default(0)
  miscellaneous      Float             @default(0)
  originalBox        Float             @default(0)
  totalAmount        Float             @default(0)
  paidAmount         Float             @default(0)
  balanceAmount      Float             @default(0)
  paymentMode        String?
  transactionDetails String?
  status             String            @default("pending")
  createdAt          DateTime          @default(now())
  vendorId           String
  vendor             Vendor            @relation(fields: [vendorId], references: [id])
  items              PurchaseItem[]
  payments           PurchasePayment[]
}

model PurchasePayment {
  id                 String       @id @default(cuid())
  amount             Float
  paymentMode        String
  transactionDetails String?
  notes              String?
  paymentDate        String
  paymentTime        String?
  createdAt          DateTime     @default(now())
  purchaseBillId     String
  purchaseBill       PurchaseBill @relation(fields: [purchaseBillId], references: [id], onDelete: Cascade)
}

model PurchaseItem {
  id              String       @id @default(cuid())
  quantity        Int
  costPrice       Float
  distributedCost Float?       @default(0)
  finalCostPrice  Float?       @default(0)
  total           Float
  productSku      String
  productName     String
  productImage    String?
  purchaseBillId  String
  productId       String
  product         Product      @relation(fields: [productId], references: [id])
  purchaseBill    PurchaseBill @relation(fields: [purchaseBillId], references: [id], onDelete: Cascade)
}

model AppSettings {
  id        String   @id @default(cuid())
  key       String   @unique
  value     String
  updatedAt DateTime @updatedAt
}
